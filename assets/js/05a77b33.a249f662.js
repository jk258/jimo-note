"use strict";(self.webpackChunkjimo=self.webpackChunkjimo||[]).push([[7591],{2825:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>c,toc:()=>d});var r=s(5893),i=s(1151);const t={},l="\u5f00\u59cb",c={id:"\u524d\u7aef/\u751f\u6001/electron/\u5f00\u59cb",title:"\u5f00\u59cb",description:"\u6587\u6863",source:"@site/docs/\u524d\u7aef/\u751f\u6001/electron/\u5f00\u59cb.md",sourceDirName:"\u524d\u7aef/\u751f\u6001/electron",slug:"/\u524d\u7aef/\u751f\u6001/electron/\u5f00\u59cb",permalink:"/jimo-note/docs/\u524d\u7aef/\u751f\u6001/electron/\u5f00\u59cb",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/\u524d\u7aef/\u751f\u6001/electron/\u5f00\u59cb.md",tags:[],version:"current",frontMatter:{},sidebar:"webSidebar",previous:{title:"\u751f\u6001",permalink:"/jimo-note/docs/category/\u751f\u6001"},next:{title:"\u95ee\u9898",permalink:"/jimo-note/docs/\u524d\u7aef/\u751f\u6001/electron/\u95ee\u9898"}},o={},d=[{value:"\u521b\u5efa\u9879\u76ee",id:"\u521b\u5efa\u9879\u76ee",level:2},{value:"Electron Forge",id:"electron-forge",level:3},{value:"electron-vite",id:"electron-vite",level:3},{value:"BrowserWindow \u914d\u7f6e",id:"browserwindow-\u914d\u7f6e",level:2},{value:"\u4f7f js \u652f\u6301 node",id:"\u4f7f-js-\u652f\u6301-node",level:3},{value:"webview",id:"webview",level:2},{value:"\u542f\u52a8",id:"\u542f\u52a8",level:3},{value:"\u65b9\u6cd5",id:"\u65b9\u6cd5",level:3},{value:"\u4e8b\u4ef6",id:"\u4e8b\u4ef6",level:3},{value:"\u4e3b\u8fdb\u7a0b\u548c\u6e32\u67d3\u8fdb\u7a0b\u7684\u901a\u8baf",id:"\u4e3b\u8fdb\u7a0b\u548c\u6e32\u67d3\u8fdb\u7a0b\u7684\u901a\u8baf",level:2},{value:"\u4e3b\u8fdb\u7a0b\u5230\u6e32\u67d3\u8fdb\u7a0b",id:"\u4e3b\u8fdb\u7a0b\u5230\u6e32\u67d3\u8fdb\u7a0b",level:3},{value:"ipcMain \u76d1\u542c\u4ece\u4e3b\u8fdb\u7a0b\u5230\u6e32\u67d3\u8fdb\u7a0b\u7684\u5f02\u6b65\u901a\u4fe1",id:"ipcmain-\u76d1\u542c\u4ece\u4e3b\u8fdb\u7a0b\u5230\u6e32\u67d3\u8fdb\u7a0b\u7684\u5f02\u6b65\u901a\u4fe1",level:4},{value:"webContents.send \u4e3b\u8fdb\u7a0b\u4e3b\u52a8\u53d1\u6d88\u606f\u7ed9\u6e32\u67d3\u8fdb\u7a0b",id:"webcontentssend-\u4e3b\u8fdb\u7a0b\u4e3b\u52a8\u53d1\u6d88\u606f\u7ed9\u6e32\u67d3\u8fdb\u7a0b",level:4},{value:"ipcRenderer\u6e32\u67d3\u8fdb\u7a0b\u5230\u4e3b\u8fdb\u7a0b",id:"ipcrenderer\u6e32\u67d3\u8fdb\u7a0b\u5230\u4e3b\u8fdb\u7a0b",level:3},{value:"\u76d1\u542c<code>ipcRenderer.on</code>",id:"\u76d1\u542cipcrendereron",level:4},{value:"\u53d1\u9001<code>ipcRenderer.send</code>",id:"\u53d1\u9001ipcrenderersend",level:4},{value:"dialog",id:"dialog",level:2},{value:"showMessageBox",id:"showmessagebox",level:3},{value:"showMessageBox",id:"showmessagebox-1",level:3}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"\u5f00\u59cb",children:"\u5f00\u59cb"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://www.electronjs.org/",children:"\u6587\u6863"})}),"\n",(0,r.jsx)(n.h2,{id:"\u521b\u5efa\u9879\u76ee",children:"\u521b\u5efa\u9879\u76ee"}),"\n",(0,r.jsx)(n.h3,{id:"electron-forge",children:(0,r.jsx)(n.a,{href:"https://www.electronforge.io/",children:"Electron Forge"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"npm init electron-app@latest my-app ||\nyarn create electron-app my-app\n"})}),"\n",(0,r.jsx)(n.h3,{id:"electron-vite",children:(0,r.jsx)(n.a,{href:"https://github.com/alex8088/electron-vite",children:"electron-vite"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"npm create @quick-start/electron\n"})}),"\n",(0,r.jsx)(n.h2,{id:"browserwindow-\u914d\u7f6e",children:"BrowserWindow \u914d\u7f6e"}),"\n",(0,r.jsx)(n.h3,{id:"\u4f7f-js-\u652f\u6301-node",children:"\u4f7f js \u652f\u6301 node"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript{4-7}",children:"const mainWindow = new BrowserWindow({\n\twidth: 800,\n\theight: 600,\n\twebPreferences: {\n\t\tnodeIntegration: true,\n\t\tcontextIsolation: false,\n\t},\n})\n"})}),"\n",(0,r.jsx)(n.h2,{id:"webview",children:(0,r.jsx)(n.a,{href:"https://www.electronjs.org/zh/docs/latest/api/webview-tag#webviewexecutejavascriptcode-usergesture",children:"webview"})}),"\n",(0,r.jsx)(n.h3,{id:"\u542f\u52a8",children:"\u542f\u52a8"}),"\n",(0,r.jsx)(n.p,{children:"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cElectron >= 5 \u7981\u7528 webview \u6807\u7b7e\u3002 \u5728\u6784\u9020 BrowserWindow \u65f6\uff0c\u9700\u8981\u901a\u8fc7\u8bbe\u7f6e webviewTag webPreferences \u9009\u9879\u6765\u542f\u7528\u6807\u7b7e"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript{5}",children:"const mainWindow = new BrowserWindow({\n\twidth: 800,\n\theight: 600,\n\twebPreferences: {\n\t\twebviewTag: true,\n\t},\n})\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u65b9\u6cd5",children:"\u65b9\u6cd5"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"<webview>.insertCSS(css)"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"css"})," string\n\u8bbe\u7f6e\u52a0\u8f7d\u7f51\u9875\u7684 css \u6837\u5f0f"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"webview.insertCSS(`body{background:red !important}`)\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"<webview>.executeJavaScript(code[, userGesture])"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"code string"}),"\n",(0,r.jsx)(n.li,{children:"userGesture boolean (\u53ef\u9009) - \u9ed8\u8ba4\u4e3a false\u3002\n\u5728\u9875\u9762\u4e2d\u6267\u884c code\u3002 \u5982\u679c\u8bbe\u7f6e\u4e86 userGesture\uff0c\u5b83\u5c06\u5728\u9875\u9762\u4e2d\u521b\u5efa\u7528\u6237\u624b\u52bf\u4e0a\u4e0b\u6587\u3002 \u50cf requestFullScreen \u8fd9\u6837\u7684\u9700\u8981\u7528\u6237\u64cd\u4f5c\u7684 HTML API \u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u9009\u9879\u6765\u5b9e\u73b0\u81ea\u52a8\u5316\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"webview.executeJavaScript(`\n    alert('test')\n  `)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u4e8b\u4ef6",children:"\u4e8b\u4ef6"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"did-start-loading"}),":\u5f53\u7ed9\u5b9a\u6846\u67b6\u4e2d\u7684\u6587\u6863\u5f00\u59cb\u52a0\u8f7d"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"webview.addEventListener('did-start-loading', function () {\n\tconsole.log('\u52a0\u8f7d\u4e2d...')\n})\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"did-stop-loading"}),":\u5f53\u7ed9\u5b9a\u6846\u67b6\u4e2d\u7684\u6587\u6863\u7ed3\u675f\u52a0\u8f7d"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"webview.addEventListener('did-stop-loading', function () {\n\tconsole.log('\u52a0\u8f7d\u5b8c\u6bd5...')\n})\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u4e3b\u8fdb\u7a0b\u548c\u6e32\u67d3\u8fdb\u7a0b\u7684\u901a\u8baf",children:"\u4e3b\u8fdb\u7a0b\u548c\u6e32\u67d3\u8fdb\u7a0b\u7684\u901a\u8baf"}),"\n",(0,r.jsx)(n.h3,{id:"\u4e3b\u8fdb\u7a0b\u5230\u6e32\u67d3\u8fdb\u7a0b",children:"\u4e3b\u8fdb\u7a0b\u5230\u6e32\u67d3\u8fdb\u7a0b"}),"\n",(0,r.jsxs)(n.h4,{id:"ipcmain-\u76d1\u542c\u4ece\u4e3b\u8fdb\u7a0b\u5230\u6e32\u67d3\u8fdb\u7a0b\u7684\u5f02\u6b65\u901a\u4fe1",children:[(0,r.jsx)(n.a,{href:"https://www.electronjs.org/zh/docs/latest/api/ipc-main",children:"ipcMain"})," \u76d1\u542c\u4ece\u4e3b\u8fdb\u7a0b\u5230\u6e32\u67d3\u8fdb\u7a0b\u7684\u5f02\u6b65\u901a\u4fe1"]}),"\n",(0,r.jsx)(n.p,{children:"ipcMain.on(channel, listener)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"channel string"}),"\n",(0,r.jsxs)(n.li,{children:["listener Function","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"event IpcMainEvent"}),"\n",(0,r.jsx)(n.li,{children:"...args any[]\n\u76d1\u542c channel, \u5f53\u65b0\u6d88\u606f\u5230\u8fbe\uff0c\u5c06\u901a\u8fc7 listener(event, args...) \u8c03\u7528 listener"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"ipcMain.on('lc-message', (event, arg) => {\n\tevent.reply('lc-reply', '\u8fd9\u662f\u4e3b\u8fdb\u7a0b\u7684\u7b54\u590d')\n\tconsole.log(arg)\n})\n"})}),"\n",(0,r.jsxs)(n.h4,{id:"webcontentssend-\u4e3b\u8fdb\u7a0b\u4e3b\u52a8\u53d1\u6d88\u606f\u7ed9\u6e32\u67d3\u8fdb\u7a0b",children:[(0,r.jsx)(n.a,{href:"https://www.electronjs.org/zh/docs/latest/api/web-contents#contentssendchannel-args",children:"webContents.send"})," \u4e3b\u8fdb\u7a0b\u4e3b\u52a8\u53d1\u6d88\u606f\u7ed9\u6e32\u67d3\u8fdb\u7a0b"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const { app, BrowserWindow } = require('electron')\nlet win = null\napp.whenReady().then(() => {\n\twin = new BrowserWindow({ width: 800, height: 600 })\n\twin.loadURL(`file://${__dirname}/index.html`)\n\twin.webContents.on('did-finish-load', () => {\n\t\twin.webContents.send('ping', 'whoooooooh!')\n\t})\n})\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"ipcrenderer\u6e32\u67d3\u8fdb\u7a0b\u5230\u4e3b\u8fdb\u7a0b",children:[(0,r.jsx)(n.a,{href:"https://www.electronjs.org/zh/docs/latest/api/ipc-renderer",children:"ipcRenderer"}),"\u6e32\u67d3\u8fdb\u7a0b\u5230\u4e3b\u8fdb\u7a0b"]}),"\n",(0,r.jsxs)(n.h4,{id:"\u76d1\u542cipcrendereron",children:["\u76d1\u542c",(0,r.jsx)(n.code,{children:"ipcRenderer.on"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"ipcRenderer.on('lc-active', (event, arg) => {\n\tconsole.log('\u76d1\u542clc-active')\n\tconsole.log(event)\n\tconsole.log(arg)\n})\n"})}),"\n",(0,r.jsxs)(n.h4,{id:"\u53d1\u9001ipcrenderersend",children:["\u53d1\u9001",(0,r.jsx)(n.code,{children:"ipcRenderer.send"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"ipcRenderer.send('lc-message', '\u5b50\u8fdb\u7a0b\u7ed9\u4e3b\u8fdb\u7a0b\u53d1\u9001\u6570\u636e')\n"})}),"\n",(0,r.jsx)(n.h2,{id:"dialog",children:(0,r.jsx)(n.a,{href:"https://www.electronjs.org/zh/docs/latest/api/dialog#dialogshowmessageboxbrowserwindow-options",children:"dialog"})}),"\n",(0,r.jsx)(n.p,{children:"\u663e\u793a\u7528\u4e8e\u6253\u5f00\u548c\u4fdd\u5b58\u6587\u4ef6\u3001\u8b66\u62a5\u7b49\u7684\u672c\u673a\u7cfb\u7edf\u5bf9\u8bdd\u6846"}),"\n",(0,r.jsx)(n.h3,{id:"showmessagebox",children:"showMessageBox"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"dialog\n\t.showOpenDialog({\n\t\t// openFile \u5141\u8bb8\u9009\u62e9\u6587\u4ef6\n\t\t// openDirectory \u5141\u8bb8\u9009\u62e9\u6587\u4ef6\u5939\n\t\t// multiSelections \u5141\u8bb8\u591a\u9009\n\t\t// showHiddenFiles \u663e\u793a\u9690\u85cf\u6587\u4ef6\n\t\t// createDirectory \u5141\u8bb8\u521b\u5efa\u6587\u4ef6\u5939\n\t\tproperties: ['openFile', 'multiSelections'],\n\t})\n\t.then((res) => {\n\t\tconsole.log(res)\n\t})\n"})}),"\n",(0,r.jsx)(n.h3,{id:"showmessagebox-1",children:"showMessageBox"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"dialog\n\t.showMessageBox({\n\t\ttype: 'warning',\n\t\ttitle: '\u5173\u95ed',\n\t\tmessage: '\u662f\u5426\u5173\u95ed',\n\t\tbuttons: ['\u53d6\u6d88', '\u786e\u5b9a'],\n\t})\n\t.then((res) => {\n\t\tconsole.log(res)\n\t\tif (res.response == 1) {\n\t\t\tapp.exit()\n\t\t}\n\t})\n"})}),"\n",(0,r.jsx)(n.p,{children:"::: danger\ndialog\u53ea\u80fd\u7528\u4e8e\u4e3b\u8fdb\u7a0b\n:::"})]})}function h(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},1151:(e,n,s)=>{s.d(n,{Z:()=>c,a:()=>l});var r=s(7294);const i={},t=r.createContext(i);function l(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);